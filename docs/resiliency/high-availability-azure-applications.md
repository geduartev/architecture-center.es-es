---
title: Alta disponibilidad para aplicaciones de Azure
description: Información general técnica y detallada sobre cómo diseñar y crear aplicaciones para alta disponibilidad en Microsoft Azure.
author: adamglick
ms.date: 05/31/2017
ms.openlocfilehash: f116b9e64f1722b5141ae90239d5c8a8b4a89487
ms.sourcegitcommit: e67b751f230792bba917754d67789a20810dc76b
ms.translationtype: HT
ms.contentlocale: es-ES
ms.lasthandoff: 04/06/2018
---
[!INCLUDE [header](../_includes/header.md)]

# <a name="high-availability-for-applications-built-on-microsoft-azure"></a><span data-ttu-id="a2cc9-103">Alta disponibilidad para aplicaciones creadas en Microsoft Azure</span><span class="sxs-lookup"><span data-stu-id="a2cc9-103">High availability for applications built on Microsoft Azure</span></span>
<span data-ttu-id="a2cc9-104">Una aplicación de alta disponibilidad asume las fluctuaciones en la disponibilidad y la carga, así como los errores temporales en los servicios dependientes y el hardware.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-104">A highly available application absorbs fluctuations in availability, load, and temporary failures in dependent services and hardware.</span></span> <span data-ttu-id="a2cc9-105">La aplicación continúa funcionando de manera aceptable, según lo definido por los requisitos empresariales o en los Acuerdos de Nivel de Servicio (SLA) de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-105">The application continues to perform acceptably, as defined by business requirements or application service-level agreements (SLAs).</span></span>

## <a name="azure-high-availability-features"></a><span data-ttu-id="a2cc9-106">Características de alta disponibilidad de Azure</span><span class="sxs-lookup"><span data-stu-id="a2cc9-106">Azure high-availability features</span></span>
<span data-ttu-id="a2cc9-107">Azure integra en su plataforma muchas características que admiten aplicaciones de alta disponibilidad.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-107">Azure has many built-in platform features that support highly available applications.</span></span> <span data-ttu-id="a2cc9-108">En esta sección se describen algunas de esas características clave.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-108">This section describes some of those key features.</span></span>

### <a name="fabric-controller"></a><span data-ttu-id="a2cc9-109">Controlador de tejido</span><span class="sxs-lookup"><span data-stu-id="a2cc9-109">Fabric controller</span></span>
<span data-ttu-id="a2cc9-110">El controlador de tejido de Azure se encarga del aprovisionamiento y la supervisión de la condición de las instancias de proceso de Azure.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-110">The Azure fabric controller provisions and monitors the condition of Azure compute instances.</span></span> <span data-ttu-id="a2cc9-111">El controlador de tejido supervisa el estado del hardware y el software de las instancias de máquinas host e invitadas.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-111">The fabric controller monitors the status of the hardware and software of the host and guest machine instances.</span></span> <span data-ttu-id="a2cc9-112">Cuando detecta un error, mantiene los SLA mediante la reubicación automática de las instancias de máquina virtual.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-112">When it detects a failure, it maintains SLAs by automatically relocating the VM instances.</span></span> <span data-ttu-id="a2cc9-113">El concepto de dominios de error y de actualización apoya también el SLA de procesos.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-113">The concept of fault and upgrade domains further supports the compute SLA.</span></span>

<span data-ttu-id="a2cc9-114">Cuando se implementan varias instancias de rol de servicios en la nube, Azure las implementa en distintos dominios de error.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-114">When multiple Cloud Service role instances are deployed, Azure deploys these instances to different fault domains.</span></span> <span data-ttu-id="a2cc9-115">Un límite de dominio de error es básicamente un bastidor de hardware diferente en la misma región.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-115">A fault domain boundary is essentially a different hardware rack in the same region.</span></span> <span data-ttu-id="a2cc9-116">Los dominios de error reducen la probabilidad de que un error de hardware localizado interrumpa el servicio de una aplicación.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-116">Fault domains reduce the probability that a localized hardware failure interrupts the service of an application.</span></span> <span data-ttu-id="a2cc9-117">No se puede administrar el número de dominios de error de los roles web o de trabajo.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-117">You cannot manage the number of fault domains of your worker roles or web roles.</span></span> <span data-ttu-id="a2cc9-118">El controlador de tejido usa recursos dedicados que son independientes de las aplicaciones hospedadas en Azure.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-118">The fabric controller uses dedicated resources that are separate from Azure-hosted applications.</span></span> <span data-ttu-id="a2cc9-119">Requiere un tiempo de actividad del 100 % porque actúa como núcleo del sistema de Azure.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-119">It requires 100 percent uptime because it serves as the nucleus of the Azure system.</span></span> <span data-ttu-id="a2cc9-120">Supervisa y administra las instancias de rol en los dominios de error.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-120">It monitors and manages role instances across fault domains.</span></span>

<span data-ttu-id="a2cc9-121">En el siguiente diagrama, se muestran los recursos compartidos de Azure que implementa y administra el controlador de tejido en distintos dominios de error.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-121">The following diagram shows Azure shared resources that the fabric controller deploys and manages across different fault domains.</span></span>

![Vista simplificada del aislamiento de los dominios de error](./images/high-availability-azure-applications/fault-domain-isolation.png)

<span data-ttu-id="a2cc9-123">Mientras que los dominios de error son separaciones físicas para mitigar errores, los dominios de actualización son unidades lógicas de separación de instancias que determinan qué instancias de un servicio se actualizarán en un momento determinado.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-123">While fault domains are physical separations to mitigate failure, upgrade domains are logical units of instance separation that determine which instances of a service will be upgraded at a specific time.</span></span> <span data-ttu-id="a2cc9-124">De forma predeterminada, se definen cinco dominios de actualización para la implementación del servicio hospedado.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-124">By default, five upgrade domains are defined for your hosted service deployment.</span></span> <span data-ttu-id="a2cc9-125">Aun así, puede cambiar ese valor en el archivo de definición de servicio.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-125">However, you can change that value in the service definition file.</span></span> <span data-ttu-id="a2cc9-126">Por ejemplo, si tiene ocho instancias del rol web, hay dos instancias en tres dominios de actualización y dos instancias en un dominio de actualización.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-126">For example, if you have eight instances of your web role, there are two instances in three upgrade domains and two instances in one upgrade domain.</span></span> <span data-ttu-id="a2cc9-127">Azure define la secuencia de actualización según el número de dominios de actualización.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-127">Azure defines the update sequence based on the number of upgrade domains.</span></span> <span data-ttu-id="a2cc9-128">Para más información, vea [Actualización de un servicio en la nube](/azure/cloud-services/cloud-services-update-azure-service/).</span><span class="sxs-lookup"><span data-stu-id="a2cc9-128">For more information, see [Update a cloud service](/azure/cloud-services/cloud-services-update-azure-service/).</span></span>

### <a name="features-in-other-services"></a><span data-ttu-id="a2cc9-129">Características de otros servicios</span><span class="sxs-lookup"><span data-stu-id="a2cc9-129">Features in other services</span></span>
<span data-ttu-id="a2cc9-130">Además de estas características de plataforma que admiten una alta disponibilidad de los recursos de procesos, Azure inserta características de alta disponibilidad en sus demás servicios.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-130">In addition to the platform features that support high availability of compute resources, Azure embeds high-availability features in its other services.</span></span> <span data-ttu-id="a2cc9-131">Por ejemplo, Azure Storage mantiene al menos tres réplicas de todos los datos en la cuenta de almacenamiento de Azure.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-131">For example, Azure Storage maintains at least three replicas of all data in your Azure storage account.</span></span> <span data-ttu-id="a2cc9-132">También permite la replicación geográfica para almacenar copias de los datos en una región secundaria.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-132">It also enables geo-replication to store copies of your data in a secondary region.</span></span> <span data-ttu-id="a2cc9-133">Azure Content Delivery Network permite que los blobs se almacenen en caché en todo el mundo por redundancia, escalabilidad y latencia más baja.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-133">The Azure Content Delivery Network allows blobs to be cached around the world for redundancy, scalability, and lower latency.</span></span> <span data-ttu-id="a2cc9-134">Azure SQL Database también mantiene varias réplicas.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-134">Azure SQL Database maintains multiple replicas as well.</span></span>

<span data-ttu-id="a2cc9-135">Para obtener información más detallada de las características de disponibilidad de la plataforma Azure, vea la [guía técnica sobre resistencia](index.md).</span><span class="sxs-lookup"><span data-stu-id="a2cc9-135">For a deeper discussion of Azure platform availability features, see [Resiliency technical guidance](index.md).</span></span> <span data-ttu-id="a2cc9-136">Vea también [Best practices for designing large-scale services on Windows Azure](https://azure.microsoft.com/blog/best-practices-for-designing-large-scale-services-on-windows-azure/)(Procedimientos recomendados para el diseño de servicios a gran escala en Microsoft Azure).</span><span class="sxs-lookup"><span data-stu-id="a2cc9-136">Also see [Best practices for designing large-scale services on Windows Azure](https://azure.microsoft.com/blog/best-practices-for-designing-large-scale-services-on-windows-azure/).</span></span>

<span data-ttu-id="a2cc9-137">Aunque Azure proporciona varias características que admiten la alta disponibilidad, es importante conocer sus limitaciones:</span><span class="sxs-lookup"><span data-stu-id="a2cc9-137">Although Azure provides multiple features that support high availability, it's important to understand their limitations:</span></span>

* <span data-ttu-id="a2cc9-138">Para los procesos, Azure garantiza que los roles estarán disponibles y en funcionamiento, pero no puede detectar si la aplicación está en ejecución o sobrecargada.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-138">For compute, Azure guarantees that your roles are available and running, but it cannot detect whether your application is running or overloaded.</span></span>
* <span data-ttu-id="a2cc9-139">Para Azure SQL Database, los datos se replican de forma sincrónica dentro de la región.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-139">For Azure SQL Database, data is replicated synchronously within the region.</span></span> <span data-ttu-id="a2cc9-140">Puede elegir la replicación geográfica activa, que permite hasta cuatro copias adicionales de la base de datos en la misma región (o en regiones diferentes).</span><span class="sxs-lookup"><span data-stu-id="a2cc9-140">You can choose active geo-replication, which allows up to four additional database copies in the same region (or different regions).</span></span> <span data-ttu-id="a2cc9-141">Aunque estas réplicas de base de datos no son copias de seguridad a partir de un momento dado, SQL Database proporciona funcionalidades de copia de seguridad a partir de un momento dado.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-141">While these database replicas are not point-in-time backups, SQL Database does provide point-in-time backup capabilities.</span></span> <span data-ttu-id="a2cc9-142">Para más información, vea [Recuperación de una instancia de Azure SQL Database mediante copias de seguridad de datos automatizadas: Restauración a un momento dado](/azure/sql-database/sql-database-recovery-using-backups#point-in-time-restore).</span><span class="sxs-lookup"><span data-stu-id="a2cc9-142">For more information, see [Recover an Azure SQL Database using automated data backups: Point-in-time restore](/azure/sql-database/sql-database-recovery-using-backups#point-in-time-restore).</span></span>
* <span data-ttu-id="a2cc9-143">Para Azure Storage, los datos de blobs y tablas se replican de forma predeterminada en una región alternativa.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-143">For Azure Storage, table data and blob data are replicated by default to an alternate region.</span></span> <span data-ttu-id="a2cc9-144">Sin embargo, no puede acceder a las réplicas hasta que Microsoft conmute por error al sitio alternativo.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-144">However, you cannot access the replicas until Microsoft chooses to fail over to the alternate site.</span></span> <span data-ttu-id="a2cc9-145">Una conmutación por error de región solo se produce durante una interrupción prolongada del servicio en toda la región y no existe ningún SLA para el tiempo de conmutación por error geográfica.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-145">A region failover occurs only during a prolonged region-wide service disruption, and there is no SLA for geo-failover time.</span></span> <span data-ttu-id="a2cc9-146">También es importante tener en cuenta que los daños en los datos se propagan rápidamente a las réplicas.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-146">It's also important to note that any data corruption quickly spreads to the replicas.</span></span> <span data-ttu-id="a2cc9-147">Por estos motivos, debe complementar las características de disponibilidad de la plataforma con características de disponibilidad específicas de la aplicación, incluida la característica de instantánea de blobs para crear copias de seguridad de los datos de blobs a partir de un momento dado.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-147">For these reasons, you must supplement platform availability features with application-specific availability features, including the blob snapshot feature to create point-in-time backups of blob data.</span></span>

### <a name="availability-sets-for-azure-virtual-machines"></a><span data-ttu-id="a2cc9-148">Conjuntos de disponibilidad para Azure Virtual Machines</span><span class="sxs-lookup"><span data-stu-id="a2cc9-148">Availability sets for Azure Virtual Machines</span></span>
<span data-ttu-id="a2cc9-149">Este documento se centra principalmente en los servicios en la nube, que usan un modelo de plataforma como servicio (PaaS).</span><span class="sxs-lookup"><span data-stu-id="a2cc9-149">This document primarily focuses on cloud services, which use a platform-as-a-service (PaaS) model.</span></span> <span data-ttu-id="a2cc9-150">También existen características de disponibilidad específicas para Azure Virtual Machines, que utilizan un modelo de infraestructura como servicio (IaaS).</span><span class="sxs-lookup"><span data-stu-id="a2cc9-150">There are also specific availability features for Azure Virtual Machines, which use an infrastructure-as-a-service (IaaS) model.</span></span> <span data-ttu-id="a2cc9-151">Para lograr una alta disponibilidad con Virtual Machines, debe usar conjuntos de disponibilidad, que sirven como una función similar para los dominios de error y de actualización.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-151">To achieve high availability with Virtual Machines, you must use availability sets, which serve a similar function to fault and upgrade domains.</span></span> <span data-ttu-id="a2cc9-152">Dentro de un conjunto de disponibilidad, Azure coloca las máquinas virtuales de forma que se impida que los errores de hardware localizados y las actividades de mantenimiento dejen inactivas todas las máquinas de ese grupo.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-152">Within an availability set, Azure positions the virtual machines in a way that prevents localized hardware faults and maintenance activities from bringing down all the machines in that group.</span></span> <span data-ttu-id="a2cc9-153">Los conjuntos de disponibilidad son necesarios para lograr el SLA de Azure para la disponibilidad de Máquinas virtuales.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-153">Availability sets are required to achieve the Azure SLA for the availability of Virtual Machines.</span></span>

<span data-ttu-id="a2cc9-154">En el siguiente diagrama se muestran dos conjuntos de disponibilidad para máquinas virtuales web y SQL Server, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-154">The following diagram shows two availability sets for web and SQL Server virtual machines, respectively.</span></span>

![Conjuntos de disponibilidad para Azure Virtual Machines](./images/high-availability-azure-applications/availability-set-for-azure-virtual-machines.png)

> [!NOTE]
> <span data-ttu-id="a2cc9-156">En el diagrama anterior, SQL Server está instalado y ejecutándose en las máquinas virtuales.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-156">In the preceding diagram, SQL Server is installed and running on virtual machines.</span></span> <span data-ttu-id="a2cc9-157">Esto difiere de Azure SQL Database, que proporciona una base de datos como servicio administrado.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-157">This is different from Azure SQL Database, which provides a database as a managed service.</span></span>
> 
> 

## <a name="application-strategies-for-high-availability"></a><span data-ttu-id="a2cc9-158">Estrategias de aplicación para la alta disponibilidad</span><span class="sxs-lookup"><span data-stu-id="a2cc9-158">Application strategies for high availability</span></span>
<span data-ttu-id="a2cc9-159">La mayoría de las estrategias de aplicación para la alta disponibilidad conllevan redundancia o la eliminación de las dependencias físicas entre los componentes de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-159">Most application strategies for high availability involve either redundancy or the removal of hard dependencies between application components.</span></span> <span data-ttu-id="a2cc9-160">El diseño de la aplicación debería admitir la tolerancia a errores durante el tiempo de inactividad esporádico de Azure o de servicios de terceros.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-160">Application design should support fault tolerance during sporadic downtime of Azure or third-party services.</span></span> <span data-ttu-id="a2cc9-161">En las secciones siguientes, se describen patrones de aplicación para aumentar la disponibilidad de los servicios en la nube.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-161">The following sections describe application patterns for improving the availability of your cloud services.</span></span>

### <a name="asynchronous-communication-and-durable-queues"></a><span data-ttu-id="a2cc9-162">Comunicación asincrónica y colas duraderas</span><span class="sxs-lookup"><span data-stu-id="a2cc9-162">Asynchronous communication and durable queues</span></span>
<span data-ttu-id="a2cc9-163">Considere la comunicación asincrónica entre servicios con acoplamiento flexible para aumentar la disponibilidad de las aplicaciones de Azure.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-163">To increase availability in Azure applications, consider asynchronous communication between loosely coupled services.</span></span> <span data-ttu-id="a2cc9-164">En este patrón, los mensajes se escriben en colas de Storage o de Azure Service Bus para procesarlos después.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-164">In this pattern, messages are written to either storage queues or Azure Service Bus queues for later processing.</span></span> <span data-ttu-id="a2cc9-165">Cuando se escribe el mensaje en la cola, se devuelve el control inmediatamente al remitente.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-165">When a message is written to the queue, control immediately returns to the sender.</span></span> <span data-ttu-id="a2cc9-166">Otro servicio de la aplicación (implementado normalmente como un rol de trabajo) procesa el mensaje.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-166">Another service of the application (typically implemented as a worker role) processes the message.</span></span> <span data-ttu-id="a2cc9-167">Si el servicio de procesamiento deja de funcionar, los mensajes se acumulan en la cola hasta que se restaure dicho servicio.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-167">If the processing service stops working, the messages accumulate in the queue until the processing service is restored.</span></span> <span data-ttu-id="a2cc9-168">No existe dependencia directa entre el remitente de front-end y el procesador de mensajes.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-168">There is no direct dependency between the front-end sender and the message processor.</span></span> <span data-ttu-id="a2cc9-169">Esto elimina las llamadas sincrónicas al servicio que pueden producir cuellos de botella en aplicaciones distribuidas.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-169">This eliminates synchronous service calls that can cause bottlenecks in distributed applications.</span></span>

<span data-ttu-id="a2cc9-170">Otra variación de este patrón almacena información sobre las llamadas a la base de datos con errores en Azure Storage (blobs, tablas o colas) o en las colas de Service Bus.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-170">A variation of this pattern stores information about failed database calls in Azure Storage (blobs, tables, or queues) or Service Bus queues.</span></span> <span data-ttu-id="a2cc9-171">Por ejemplo, una llamada sincrónica dentro de una aplicación a otro servicio (como Azure SQL Database) produce un error repetidamente.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-171">For example, a synchronous call within an application to another service (such as Azure SQL Database) fails repeatedly.</span></span> <span data-ttu-id="a2cc9-172">Es posible que pueda serializar dicha solicitud en un almacenamiento duradero.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-172">You might be able to serialize that request into durable storage.</span></span> <span data-ttu-id="a2cc9-173">Más adelante, cuando el servicio o la base de datos vuelvan a estar en línea, la aplicación puede enviar de nuevo la solicitud desde el almacenamiento.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-173">At some later point when the service or database is back online, the application can resubmit the request from storage.</span></span> <span data-ttu-id="a2cc9-174">La diferencia en este modelo es que la ubicación intermedia se usa solo durante los errores, no como una parte regular del flujo de trabajo de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-174">The difference in this model is that the intermediate location is used only during failures, not as a regular part of the application workflow.</span></span>

<span data-ttu-id="a2cc9-175">En ambos escenarios, la comunicación asincrónica y el almacenamiento intermedio impiden que un servicio back-end inactivo haga que toda la aplicación deje de funcionar.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-175">In both scenarios, asynchronous communication and intermediate storage prevent a downed back-end service from bringing down the entire application.</span></span> <span data-ttu-id="a2cc9-176">Las colas actúan como intermediario lógico.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-176">Queues serve as a logical intermediary.</span></span> <span data-ttu-id="a2cc9-177">Para más información sobre cómo elegir entre los servicios de cola, vea [Colas de Storage y de Service Bus: comparación y diferencias](/azure/service-bus-messaging/service-bus-azure-and-service-bus-queues-compared-contrasted/).</span><span class="sxs-lookup"><span data-stu-id="a2cc9-177">For more information on choosing between queuing services, see [Azure queues and Azure Service Bus queues &mdash; compared and contrasted](/azure/service-bus-messaging/service-bus-azure-and-service-bus-queues-compared-contrasted/).</span></span>

### <a name="fault-detection-and-retry-logic"></a><span data-ttu-id="a2cc9-178">Detección de errores y lógica de reintento</span><span class="sxs-lookup"><span data-stu-id="a2cc9-178">Fault detection and retry logic</span></span>
<span data-ttu-id="a2cc9-179">Un aspecto clave del diseño de una aplicación de alta disponibilidad es utilizar la lógica de reintento en el código para controlar correctamente un servicio que no está disponible temporalmente.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-179">A key aspect of the design of highly available applications is the use of retry logic within code to gracefully handle a service that is temporarily unavailable.</span></span> <span data-ttu-id="a2cc9-180">Las versiones recientes de los SDK de Azure Storage y Azure Service Bus admiten los reintentos de forma nativa.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-180">Recent versions of SDKs for both Azure Storage and Azure Service Bus natively support retries.</span></span> <span data-ttu-id="a2cc9-181">Para más información sobre cómo proporcionar una lógica de reintento personalizada para la aplicación, vea el [patrón de reintento](../patterns/retry.md).</span><span class="sxs-lookup"><span data-stu-id="a2cc9-181">For more information on providing custom retry logic for your application, see the [Retry pattern](../patterns/retry.md).</span></span>

### <a name="reference-data-pattern-for-high-availability"></a><span data-ttu-id="a2cc9-182">Patrón de datos de referencia para la alta disponibilidad</span><span class="sxs-lookup"><span data-stu-id="a2cc9-182">Reference data pattern for high availability</span></span>
<span data-ttu-id="a2cc9-183">Los datos de referencia son los datos de solo lectura de una aplicación.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-183">Reference data is the read-only data of an application.</span></span> <span data-ttu-id="a2cc9-184">Proporcionan el contexto empresarial en que la aplicación genera datos transaccionales durante una operación empresarial.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-184">This data provides the business context within which the application generates transactional data during a business operation.</span></span> <span data-ttu-id="a2cc9-185">La integridad de los datos transaccionales depende de una instantánea de los datos de referencia en el momento en que se completó la transacción.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-185">The integrity of transactional data depends on a snapshot of the reference data at the time the transaction was completed.</span></span>

<span data-ttu-id="a2cc9-186">Los datos de referencia son necesarios para el correcto funcionamiento de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-186">Reference data is necessary for the proper operation of the application.</span></span> <span data-ttu-id="a2cc9-187">Varias aplicaciones crean y mantienen datos de referencia; los sistemas de administración de datos maestros (MDM) suelen realizar esta función.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-187">Various applications create and maintain reference data; master data management (MDM) systems often perform this function.</span></span> <span data-ttu-id="a2cc9-188">Estos sistemas se encargan del ciclo de vida de los datos de referencia.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-188">These systems are responsible for the life cycle of the reference data.</span></span> <span data-ttu-id="a2cc9-189">Algunos ejemplos de datos de referencia son un catálogo de productos, un maestro de empleados, un maestro de piezas o un maestro de equipos.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-189">Examples of reference data include product catalog, employee master, parts master, and equipment master.</span></span> <span data-ttu-id="a2cc9-190">Los datos de referencia también se pueden originar fuera de la organización; por ejemplo, códigos postales o tipos impositivos.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-190">Reference data can also originate from outside the organization, for example, postal codes or tax rates.</span></span> <span data-ttu-id="a2cc9-191">Las estrategias para aumentar la disponibilidad de los datos de referencia suelen ser menos complicadas que las de los datos transaccionales.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-191">Strategies for increasing the availability of reference data are typically less difficult than those for transactional data.</span></span> <span data-ttu-id="a2cc9-192">La ventaja de los datos de referencia es que, por lo general, son inmutables.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-192">Reference data has the advantage of being mostly immutable.</span></span>

<span data-ttu-id="a2cc9-193">Los roles web y de trabajo de Azure que consumen datos de referencia se pueden establecer como autónomos en tiempo de ejecución mediante la implementación de dichos datos junto con la aplicación.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-193">Azure web and worker roles that consume reference data can be made autonomous at runtime by deploying the reference data along with the application.</span></span> <span data-ttu-id="a2cc9-194">Este enfoque resulta ideal si el tamaño del almacenamiento local permite esa implementación.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-194">This approach is ideal if the size of the local storage allows such a deployment.</span></span> <span data-ttu-id="a2cc9-195">Las bases de datos SQL o NoSQL insertadas o los archivos XML implementados localmente contribuyen a la autonomía de las unidades de escalado de procesos de Azure.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-195">Embedded SQL databases, NoSQL databases, or XML files deployed locally help with the autonomy of Azure compute scale units.</span></span> <span data-ttu-id="a2cc9-196">Sin embargo, debe poseer un mecanismo para actualizar los datos en cada rol sin necesidad de volver a implementarlos.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-196">However, you should have a mechanism to update the data in each role without requiring redeployment.</span></span> <span data-ttu-id="a2cc9-197">Para ello, coloque las actualizaciones de los datos de referencia en un punto de conexión del almacenamiento en la nube (por ejemplo, Azure Blob Storage o SQL Database).</span><span class="sxs-lookup"><span data-stu-id="a2cc9-197">To do this, place any updates to the reference data at a cloud storage endpoint (for example, Azure Blob storage or SQL Database).</span></span> <span data-ttu-id="a2cc9-198">Agregue código a cada rol que descarga las actualizaciones de datos en los nodos de proceso cuando se inicia el rol.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-198">Add code to each role that downloads the data updates into the compute nodes at role startup.</span></span> <span data-ttu-id="a2cc9-199">Como alternativa, agregue código que permita a un administrador realizar una descarga forzada en las instancias de rol.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-199">Alternatively, add code that allows an administrator to perform a forced download into the role instances.</span></span>

<span data-ttu-id="a2cc9-200">Para aumentar la disponibilidad, los roles también deben contener un conjunto de los datos de referencia por si el almacenamiento está inactivo.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-200">To increase availability, the roles should also contain a set of reference data in case storage is down.</span></span> <span data-ttu-id="a2cc9-201">Los roles se pueden iniciar con un conjunto básico de datos de referencia hasta que el recurso de almacenamiento esté disponible para las actualizaciones.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-201">Roles can start with a basic set of reference data until the storage resource becomes available for the updates.</span></span>

![Alta disponibilidad de aplicaciones mediante nodos de proceso autónomos](./images/high-availability-azure-applications/application-high-availability-through-autonomous-compute-nodes.png)

<span data-ttu-id="a2cc9-203">Con este patrón, las nuevas implementaciones o instancias de rol pueden tardar más en iniciarse si va a implementar o descargar grandes volúmenes de datos de referencia.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-203">With this pattern, new deployments or role instances may take longer to start if you are deploying or downloading large amounts of reference data.</span></span> <span data-ttu-id="a2cc9-204">Este inconveniente puede ser aceptable a cambio de contar con la autonomía de disponer inmediatamente de los datos de referencia en cada rol, en lugar de depender de servicios de almacenamiento externos.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-204">This tradeoff might be acceptable for the autonomy of having the reference data immediately available on each role, rather than depending on external storage services.</span></span>

### <a name="transactional-data-pattern-for-high-availability"></a><span data-ttu-id="a2cc9-205">Patrón de datos transaccionales para la alta disponibilidad</span><span class="sxs-lookup"><span data-stu-id="a2cc9-205">Transactional data pattern for high availability</span></span>
<span data-ttu-id="a2cc9-206">Los datos transaccionales son aquellos generados por la aplicación en un contexto empresarial.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-206">Transactional data is the data that the application generates in a business context.</span></span> <span data-ttu-id="a2cc9-207">Se trata de una combinación del conjunto de procesos de negocio implementados por la aplicación y de los datos de referencia en que se sustentan.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-207">Transactional data is a combination of the set of business processes that the application implements and the reference data that supports these processes.</span></span> <span data-ttu-id="a2cc9-208">Algunos ejemplos de datos transaccionales son los pedidos, los avisos de envío avanzados, las facturas y las oportunidades de CRM.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-208">Examples of transactional data can include orders, advanced shipping notices, invoices, and customer relationship management (CRM) opportunities.</span></span> <span data-ttu-id="a2cc9-209">Los datos transaccionales se proporcionan a sistemas externos para mantener un registro o para procesarlos más adelante.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-209">Transactional data is supplied to external systems for record keeping or for further processing.</span></span>

<span data-ttu-id="a2cc9-210">Los datos de referencia pueden cambiar dentro de los sistemas encargados de ellos.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-210">Reference data can change within the systems that are responsible for that data.</span></span> <span data-ttu-id="a2cc9-211">Por tanto, los datos transaccionales deben guardar el contexto de los datos de referencia en un momento dado, para minimizar las dependencias externas para su coherencia semántica.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-211">Therefore, transactional data must save the point-in-time reference data context to minimize external dependencies for its semantic consistency.</span></span> <span data-ttu-id="a2cc9-212">Por ejemplo, un producto puede eliminarse del catálogo unos meses después de que se haya entregado un pedido.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-212">For example, a product may be removed from the catalog several months after an order is fulfilled.</span></span> <span data-ttu-id="a2cc9-213">Se recomienda almacenar el máximo contexto de datos de referencia posible con la transacción.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-213">Storing as much reference data context as possible with the transaction is recommended.</span></span> <span data-ttu-id="a2cc9-214">Este enfoque conserva la semántica asociada a la transacción, incluso si los datos de referencia cambian una vez capturada la transacción.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-214">This approach preserves the semantics associated with the transaction, even if the reference data changes after the transaction is captured.</span></span>

<span data-ttu-id="a2cc9-215">Como se ha mencionado, las arquitecturas que usan el acoplamiento flexible y la comunicación asincrónica se proporcionan a niveles más altos de disponibilidad.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-215">As mentioned previously, architectures that use loose coupling and asynchronous communication can provide higher levels of availability.</span></span> <span data-ttu-id="a2cc9-216">Esto también es válido para los datos transaccionales, aunque la implementación es más compleja.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-216">This is true for transactional data as well, but the implementation is more complex.</span></span> <span data-ttu-id="a2cc9-217">Normalmente, los patrones transaccionales tradicionales confían en la base de datos para garantizar la transacción.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-217">Traditional transactional patterns usually rely on the database for guaranteeing the transaction.</span></span> <span data-ttu-id="a2cc9-218">Cuando se incluyen capas intermedias, el código de la aplicación debe administrar correctamente los datos en diversas capas para garantizar una coherencia y una durabilidad suficientes.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-218">When you introduce intermediate layers, the application code must correctly handle the data at various layers to ensure sufficient consistency and durability.</span></span>

<span data-ttu-id="a2cc9-219">La secuencia siguiente describe un flujo de trabajo que separa la captura de los datos transaccionales de su procesamiento:</span><span class="sxs-lookup"><span data-stu-id="a2cc9-219">The following sequence describes a workflow that separates the capture of transactional data from its processing:</span></span>

1. <span data-ttu-id="a2cc9-220">Nodo de proceso web: se presentan los datos de referencia.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-220">Web compute node: Present reference data.</span></span>
2. <span data-ttu-id="a2cc9-221">Almacenamiento externo: se guardan los datos transaccionales intermedios.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-221">External storage: Save intermediate transactional data.</span></span>
3. <span data-ttu-id="a2cc9-222">Nodo de proceso web: se completa la transacción de usuario final.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-222">Web compute node: Complete the end-user transaction.</span></span>
4. <span data-ttu-id="a2cc9-223">Nodo de proceso web: se envían los datos transaccionales completados junto con el contexto de los datos de referencia a un almacenamiento duradero temporal cuya respuesta predecible está garantizada.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-223">Web compute node: Send the completed transactional data with its reference data context to temporary durable storage that is guaranteed to give a predictable response.</span></span>
5. <span data-ttu-id="a2cc9-224">Nodo de proceso web: se señala al usuario final la finalización de la transacción.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-224">Web compute node: Signal the end-user completion of the transaction.</span></span>
6. <span data-ttu-id="a2cc9-225">Nodo de proceso en segundo plano: se extraen los datos transaccionales, se siguen procesando si es necesario y se envían a su ubicación final de almacenamiento en el sistema actual.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-225">Background compute node: Extract the transactional data, process it further if necessary, and send it to its final storage location in the current system.</span></span>

<span data-ttu-id="a2cc9-226">El siguiente diagrama muestra una posible implementación de este diseño en un servicio en la nube hospedado por Azure.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-226">The following diagram shows one possible implementation of this design in an Azure-hosted cloud service.</span></span>

![Alta disponibilidad a través del acoplamiento flexible](./images/disaster-recovery-high-availability-azure-applications/application-high-availability-through-loose-coupling.png)

<span data-ttu-id="a2cc9-228">Las flechas discontinuas del diagrama anterior indican un procesamiento asincrónico.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-228">The dashed arrows in the preceding diagram indicate asynchronous processing.</span></span> <span data-ttu-id="a2cc9-229">El rol web de front-end desconoce este procesamiento asincrónico.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-229">The front-end web role is not aware of this asynchronous processing.</span></span> <span data-ttu-id="a2cc9-230">Esto lleva al almacenamiento de la transacción en su destino final con referencia al sistema actual.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-230">This leads to the storage of the transaction at its final destination with reference to the current system.</span></span> <span data-ttu-id="a2cc9-231">A consecuencia de la latencia aportada por este modelo asincrónico, los datos transaccionales no están disponibles de inmediato para la consulta.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-231">Due to the latency that this asynchronous model introduces, the transactional data is not immediately available for query.</span></span> <span data-ttu-id="a2cc9-232">Por lo tanto, cada unidad de datos transaccionales necesita guardarse en caché o en una sesión de usuario para satisfacer los requisitos inmediatos de la interfaz de usuario.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-232">Therefore, each unit of the transactional data needs to be saved in a cache or a user session to meet the immediate UI needs.</span></span>

<span data-ttu-id="a2cc9-233">Por consiguiente, el rol web es autónomo del resto de la infraestructura.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-233">The web role is autonomous from the rest of the infrastructure.</span></span> <span data-ttu-id="a2cc9-234">Su perfil de disponibilidad es una combinación del rol web y la cola de Azure, y no de toda la infraestructura.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-234">Its availability profile is a combination of the web role and the Azure queue and not the entire infrastructure.</span></span> <span data-ttu-id="a2cc9-235">Además de la alta disponibilidad, este enfoque permite que el rol web se escale horizontalmente, independientemente del almacenamiento back-end.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-235">In addition to high availability, this approach allows the web role to scale horizontally, independent of the back-end storage.</span></span> <span data-ttu-id="a2cc9-236">Este modelo de alta disponibilidad puede afectar a la vertiente económica de las operaciones.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-236">This high-availability model can have an impact on the economics of operations.</span></span> <span data-ttu-id="a2cc9-237">Los componentes adicionales, como las colas de Azure y los roles de trabajo, pueden afectar al costo por uso mensual.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-237">Additional components like Azure queues and worker roles can affect monthly usage costs.</span></span>

<span data-ttu-id="a2cc9-238">En el diagrama anterior se muestra una implementación de este enfoque desacoplado de datos transaccionales.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-238">The previous diagram shows one implementation of this decoupled approach to transactional data.</span></span> <span data-ttu-id="a2cc9-239">pero existen muchas otras posibilidades.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-239">There are many other possible implementations.</span></span> <span data-ttu-id="a2cc9-240">En la siguiente lista, se proporcionan algunas alternativas:</span><span class="sxs-lookup"><span data-stu-id="a2cc9-240">The following list provides some alternatives:</span></span>

* <span data-ttu-id="a2cc9-241">Se puede colocar un rol de trabajo entre el rol web y la cola de almacenamiento.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-241">A worker role might be placed between the web role and the storage queue.</span></span>
* <span data-ttu-id="a2cc9-242">Se puede usar una cola de Service Bus en lugar de una cola de Azure Storage.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-242">A Service Bus queue can be used instead of an Azure Storage queue.</span></span>
* <span data-ttu-id="a2cc9-243">El destino final podría ser Azure Storage o un proveedor de base de datos diferente.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-243">The final destination might be Azure Storage or a different database provider.</span></span>
* <span data-ttu-id="a2cc9-244">Se puede utilizar Caché de Azure en la capa web para proporcionar los requisitos inmediatos de almacenamiento en caché después de la transacción.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-244">Azure Cache can be used at the web layer to provide the immediate caching requirements after the transaction.</span></span>

### <a name="scalability-patterns"></a><span data-ttu-id="a2cc9-245">Patrones de escalabilidad</span><span class="sxs-lookup"><span data-stu-id="a2cc9-245">Scalability patterns</span></span>
<span data-ttu-id="a2cc9-246">Es importante tener en cuenta que la escalabilidad de un servicio en la nube afecta directamente a la disponibilidad.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-246">It's important to note that the scalability of a cloud service directly affects availability.</span></span> <span data-ttu-id="a2cc9-247">Si una carga mayor hace que el servicio no responda, la percepción del usuario es que la aplicación no está funcionando.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-247">If increased load causes your service to be unresponsive, the user perception is that the application is down.</span></span> <span data-ttu-id="a2cc9-248">Siga las prácticas demostradas para la escalabilidad en función de la carga esperada de la aplicación y sus expectativas futuras.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-248">Follow proven practices for scalability based on your expected application load and future expectations.</span></span> <span data-ttu-id="a2cc9-249">Para maximizar la escala, se tienen en cuenta muchas consideraciones, como el uso de una única cuenta de almacenamiento o varias, el uso compartido entre varias bases de datos y las estrategias de almacenamiento en caché.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-249">Maximizing scale involves many considerations, such as single versus multiple storage accounts, sharing across multiple databases, and caching strategies.</span></span> <span data-ttu-id="a2cc9-250">Para obtener información detallada sobre estos patrones, vea [Best practices for designing large-scale services on Microsoft Azure](https://azure.microsoft.com/blog/best-practices-for-designing-large-scale-services-on-windows-azure/) (Procedimientos recomendados para diseñar servicios a gran escala en Microsoft Azure).</span><span class="sxs-lookup"><span data-stu-id="a2cc9-250">For in-depth information about these patterns, see [Best practices for designing large-scale services on Microsoft Azure](https://azure.microsoft.com/blog/best-practices-for-designing-large-scale-services-on-windows-azure/).</span></span>

## <a name="next-steps"></a><span data-ttu-id="a2cc9-251">Pasos siguientes</span><span class="sxs-lookup"><span data-stu-id="a2cc9-251">Next steps</span></span>
<span data-ttu-id="a2cc9-252">En esta serie de documentos se tratan la recuperación ante desastres y la alta disponibilidad para aplicaciones creadas en Microsoft Azure.</span><span class="sxs-lookup"><span data-stu-id="a2cc9-252">This series of documents covers disaster recovery and high availability for applications built on Microsoft Azure.</span></span> <span data-ttu-id="a2cc9-253">El siguiente artículo de la serie es [Recuperación ante desastres para aplicaciones generadas en Microsoft Azure](disaster-recovery-azure-applications.md).</span><span class="sxs-lookup"><span data-stu-id="a2cc9-253">The next article in the series is [Disaster recovery for applications built on Microsoft Azure](disaster-recovery-azure-applications.md).</span></span>

