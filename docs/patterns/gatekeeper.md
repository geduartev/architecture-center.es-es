---
title: Gatekeeper
description: Protege aplicaciones y servicios mediante una instancia de host dedicada que actúa como agente entre los clientes y la aplicación o servicio, valida y sanea las solicitudes, y pasa las solicitudes y datos entre ellos.
keywords: Patrón de diseño
author: dragon119
ms.date: 06/23/2017
pnp.series.title: Cloud Design Patterns
pnp.pattern.categories:
- security
ms.openlocfilehash: 39f8548bbccb5e19d433f65b2e7e09147d676996
ms.sourcegitcommit: b0482d49aab0526be386837702e7724c61232c60
ms.translationtype: HT
ms.contentlocale: es-ES
ms.lasthandoff: 11/14/2017
---
# <a name="gatekeeper-pattern"></a><span data-ttu-id="d7ed1-104">Patrón Gatekeeper</span><span class="sxs-lookup"><span data-stu-id="d7ed1-104">Gatekeeper pattern</span></span>

[!INCLUDE [header](../_includes/header.md)]

<span data-ttu-id="d7ed1-105">Protege aplicaciones y servicios mediante una instancia de host dedicada que actúa como agente entre los clientes y la aplicación o servicio, valida y sanea las solicitudes, y pasa las solicitudes y datos entre ellos.</span><span class="sxs-lookup"><span data-stu-id="d7ed1-105">Protect applications and services by using a dedicated host instance that acts as a broker between clients and the application or service, validates and sanitizes requests, and passes requests and data between them.</span></span> <span data-ttu-id="d7ed1-106">Esto puede proporcionar una capa adicional de seguridad y limitar la superficie de ataque del sistema.</span><span class="sxs-lookup"><span data-stu-id="d7ed1-106">This can provide an additional layer of security, and limit the attack surface of the system.</span></span>

## <a name="context-and-problem"></a><span data-ttu-id="d7ed1-107">Contexto y problema</span><span class="sxs-lookup"><span data-stu-id="d7ed1-107">Context and problem</span></span>

<span data-ttu-id="d7ed1-108">Las aplicaciones exponen su funcionalidad a los clientes mediante la aceptación y el procesamiento de solicitudes.</span><span class="sxs-lookup"><span data-stu-id="d7ed1-108">Applications expose their functionality to clients by accepting and processing requests.</span></span> <span data-ttu-id="d7ed1-109">En escenarios hospedados en la nube, las aplicaciones exponen los puntos de conexión a los que los clientes se conectan y suelen incluyen el código para controlar las solicitudes de clientes.</span><span class="sxs-lookup"><span data-stu-id="d7ed1-109">In cloud-hosted scenarios, applications expose endpoints clients connect to, and typically include the code to handle the requests from clients.</span></span> <span data-ttu-id="d7ed1-110">Este código realiza la autenticación y la validación, el procesamiento de algunas de las solicitudes, o de todas, y es probable que acceda al almacenamiento y a otros servicios en nombre del cliente.</span><span class="sxs-lookup"><span data-stu-id="d7ed1-110">This code performs authentication and validation, some or all request processing, and is likely to accesses storage and other services on behalf of the client.</span></span>

<span data-ttu-id="d7ed1-111">Si un usuario malintencionado puede poner en peligro el sistema y obtener acceso al entorno de hospedaje de la aplicación, los mecanismos de seguridad que usa, como las credenciales y las claves de almacenamiento, y se exponen los servicios y datos a los que accede.</span><span class="sxs-lookup"><span data-stu-id="d7ed1-111">If a malicious user is able to compromise the system and gain access to the application’s hosting environment, the security mechanisms it uses such as credentials and storage keys, and the services and data it accesses, are exposed.</span></span> <span data-ttu-id="d7ed1-112">Como consecuencia, el usuario malintencionado puede obtener acceso libre a información confidencial y a otros servicios.</span><span class="sxs-lookup"><span data-stu-id="d7ed1-112">As a result, the malicious user can gain unrestrained access to sensitive information and other services.</span></span>

## <a name="solution"></a><span data-ttu-id="d7ed1-113">Solución</span><span class="sxs-lookup"><span data-stu-id="d7ed1-113">Solution</span></span>

<span data-ttu-id="d7ed1-114">Para minimizar el riesgo de que los clientes obtengan acceso a información confidencial y a servicios, desacople los hosts o las tareas que exponen puntos de conexión públicos desde el código que procesa las solicitudes y accede al almacenamiento.</span><span class="sxs-lookup"><span data-stu-id="d7ed1-114">To minimize the risk of clients gaining access to sensitive information and services, decouple hosts or tasks that expose public endpoints from the code that processes requests and accesses storage.</span></span> <span data-ttu-id="d7ed1-115">Puede conseguirlo mediante una fachada o una tarea dedicada que interactúa con los clientes y, a continuación, entrega la solicitud&mdash;quizás a través de una interfaz desacoplada&mdash;a los hosts o las tareas que controlarán la solicitud.</span><span class="sxs-lookup"><span data-stu-id="d7ed1-115">You can achieve this by using a façade or a dedicated task that interacts with clients and then hands off the request&mdash;perhaps through a decoupled interface&mdash;to the hosts or tasks that'll handle the request.</span></span> <span data-ttu-id="d7ed1-116">La ilustración proporciona información general de alto nivel de este patrón.</span><span class="sxs-lookup"><span data-stu-id="d7ed1-116">The figure provides a high-level overview of this pattern.</span></span>

![Información general de alto nivel de este patrón](./_images/gatekeeper-diagram.png)


<span data-ttu-id="d7ed1-118">El patrón del equipo selector se puede usar simplemente para proteger el almacenamiento, o bien se puede utilizar como una fachada más completa para proteger todas las funciones de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="d7ed1-118">The gatekeeper pattern can be used to simply protect storage, or it can be used as a more comprehensive façade to protect all of the functions of the application.</span></span> <span data-ttu-id="d7ed1-119">Los factores importantes son:</span><span class="sxs-lookup"><span data-stu-id="d7ed1-119">The important factors are:</span></span>

- <span data-ttu-id="d7ed1-120">**Validación controlada.**</span><span class="sxs-lookup"><span data-stu-id="d7ed1-120">**Controlled validation.**</span></span> <span data-ttu-id="d7ed1-121">El equipo selector valida todas las solicitudes y rechaza aquellas que no cumplen los requisitos de validación.</span><span class="sxs-lookup"><span data-stu-id="d7ed1-121">The gatekeeper validates all requests, and rejects those that don't meet validation requirements.</span></span>
- <span data-ttu-id="d7ed1-122">**Riesgo y exposición limitados.**</span><span class="sxs-lookup"><span data-stu-id="d7ed1-122">**Limited risk and exposure.**</span></span> <span data-ttu-id="d7ed1-123">El equipo selector no tiene acceso a las credenciales o las claves que usa el host de confianza para acceder al almacenamiento y a los servicios.</span><span class="sxs-lookup"><span data-stu-id="d7ed1-123">The gatekeeper doesn't have access to the credentials or keys used by the trusted host to access storage and services.</span></span> <span data-ttu-id="d7ed1-124">Si el equipo selector corre peligro, el atacante no obtiene acceso a estas credenciales o claves.</span><span class="sxs-lookup"><span data-stu-id="d7ed1-124">If the gatekeeper is compromised, the attacker doesn't get access to these credentials or keys.</span></span>
- <span data-ttu-id="d7ed1-125">**Seguridad adecuada.**</span><span class="sxs-lookup"><span data-stu-id="d7ed1-125">**Appropriate security.**</span></span> <span data-ttu-id="d7ed1-126">El equipo selector se ejecuta en un modo con privilegios limitados, mientras que el resto de la aplicación se ejecuta en el modo de plena confianza necesario para acceder al almacenamiento y a los servicios.</span><span class="sxs-lookup"><span data-stu-id="d7ed1-126">The gatekeeper runs in a limited privilege mode, while the rest of the application runs in the full trust mode required to access storage and services.</span></span> <span data-ttu-id="d7ed1-127">Si el equipo selector está en peligro, no puede acceder directamente a los servicios de la aplicación ni a los datos.</span><span class="sxs-lookup"><span data-stu-id="d7ed1-127">If the gatekeeper is compromised, it can't directly access the application services or data.</span></span>

<span data-ttu-id="d7ed1-128">Este patrón actúa como un firewall en una topografía de red típica.</span><span class="sxs-lookup"><span data-stu-id="d7ed1-128">This pattern acts like a firewall in a typical network topography.</span></span> <span data-ttu-id="d7ed1-129">Permite que el equipo selector examine las solicitudes y tome una decisión sobre si se debe pasar una de ellas al host de confianza (a veces denominado el maestro de claves) que realiza las tareas necesarias.</span><span class="sxs-lookup"><span data-stu-id="d7ed1-129">It allows the gatekeeper to examine requests and make a decision about whether to pass the request on to the trusted host (sometimes called the keymaster) that performs the required tasks.</span></span> <span data-ttu-id="d7ed1-130">Esta decisión normalmente requiere que el equipo selector valide y corrija el contenido de la solicitud antes de pasarlo al host de confianza.</span><span class="sxs-lookup"><span data-stu-id="d7ed1-130">This decision typically requires the gatekeeper to validate and sanitize the request content before passing it on to the trusted host.</span></span>

## <a name="issues-and-considerations"></a><span data-ttu-id="d7ed1-131">Problemas y consideraciones</span><span class="sxs-lookup"><span data-stu-id="d7ed1-131">Issues and considerations</span></span>

<span data-ttu-id="d7ed1-132">Tenga en cuenta los puntos siguientes al decidir cómo implementar este patrón:</span><span class="sxs-lookup"><span data-stu-id="d7ed1-132">Consider the following points when deciding how to implement this pattern:</span></span>

- <span data-ttu-id="d7ed1-133">Asegúrese de que los hosts de confianza a los que el equipo selector pasa las solicitudes exponen solo puntos de conexión internos o protegidos, y que se conectan solo al equipo selector.</span><span class="sxs-lookup"><span data-stu-id="d7ed1-133">Ensure that the trusted hosts the gatekeeper passes requests to expose only internal or protected endpoints, and connect only to the gatekeeper.</span></span> <span data-ttu-id="d7ed1-134">Los hosts de confianza no deben exponer los puntos de conexión externos ni las interfaces.</span><span class="sxs-lookup"><span data-stu-id="d7ed1-134">The trusted hosts shouldn't expose any external endpoints or interfaces.</span></span>
- <span data-ttu-id="d7ed1-135">El equipo selector debe ejecutarse en un modo con privilegios limitados.</span><span class="sxs-lookup"><span data-stu-id="d7ed1-135">The gatekeeper must run in a limited privilege mode.</span></span> <span data-ttu-id="d7ed1-136">Normalmente esto significa que el equipo selector y el host de confianza se ejecutan en servicios hospedados o máquinas virtuales independientes.</span><span class="sxs-lookup"><span data-stu-id="d7ed1-136">Typically this means running the gatekeeper and the trusted host in separate hosted services or virtual machines.</span></span>
- <span data-ttu-id="d7ed1-137">El equipo selector no debe realizar ningún tipo de procesamiento relacionado con la aplicación o los servicios, ni acceder a los datos.</span><span class="sxs-lookup"><span data-stu-id="d7ed1-137">The gatekeeper shouldn't perform any processing related to the application or services, or access any data.</span></span> <span data-ttu-id="d7ed1-138">Su función es exclusivamente validar y corregir solicitudes.</span><span class="sxs-lookup"><span data-stu-id="d7ed1-138">Its function is purely to validate and sanitize requests.</span></span> <span data-ttu-id="d7ed1-139">Es posible que los hosts de confianza tengan que realizar una validación adicional de las solicitudes, pero la validación principal debe hacerla el equipo selector.</span><span class="sxs-lookup"><span data-stu-id="d7ed1-139">The trusted hosts might need to perform additional validation of requests, but the core validation should be performed by the gatekeeper.</span></span>
- <span data-ttu-id="d7ed1-140">Cuando sea posible, utilice un canal de comunicación seguro (HTTPS, SSL o TLS) entre el equipo selector y los hosts de confianza o las tareas.</span><span class="sxs-lookup"><span data-stu-id="d7ed1-140">Use a secure communication channel (HTTPS, SSL, or TLS) between the gatekeeper and the trusted hosts or tasks where this is possible.</span></span> <span data-ttu-id="d7ed1-141">Sin embargo, algunos entornos de hospedaje no admiten HTTPS en los puntos de conexión internos.</span><span class="sxs-lookup"><span data-stu-id="d7ed1-141">However, some hosting environments don't support HTTPS on internal endpoints.</span></span>
- <span data-ttu-id="d7ed1-142">La incorporación de una capa adicional a la aplicación para implementar el modelo del equipo selector es probable que afecte al rendimiento debido al procesamiento adicional y a la comunicación de red que requiere.</span><span class="sxs-lookup"><span data-stu-id="d7ed1-142">Adding the extra layer to the application to implement the gatekeeper pattern is likely to have some impact on performance due to the additional processing and network communication it requires.</span></span>
- <span data-ttu-id="d7ed1-143">La instancia del equipo selector podría ser un único punto de error.</span><span class="sxs-lookup"><span data-stu-id="d7ed1-143">The gatekeeper instance could be a single point of failure.</span></span> <span data-ttu-id="d7ed1-144">Para minimizar el impacto de un error, considere la posibilidad de implementar instancias adicionales y usar un mecanismo de escalado automático para garantizar la capacidad para mantener la disponibilidad.</span><span class="sxs-lookup"><span data-stu-id="d7ed1-144">To minimize the impact of a failure, consider deploying additional instances and using an autoscaling mechanism to ensure capacity to maintain availability.</span></span>

## <a name="when-to-use-this-pattern"></a><span data-ttu-id="d7ed1-145">Cuándo usar este patrón</span><span class="sxs-lookup"><span data-stu-id="d7ed1-145">When to use this pattern</span></span>

<span data-ttu-id="d7ed1-146">Este patrón es útil para:</span><span class="sxs-lookup"><span data-stu-id="d7ed1-146">This pattern is useful for:</span></span>

- <span data-ttu-id="d7ed1-147">Aplicaciones que controlan información confidencial, exponen servicios que deben tener un alto grado de protección frente a ataques malintencionados o realizar operaciones de misión crítica que no se deben interrumpir.</span><span class="sxs-lookup"><span data-stu-id="d7ed1-147">Applications that handle sensitive information, expose services that must have a high degree of protection from malicious attacks, or perform mission-critical operations that shouldn't be disrupted.</span></span>
- <span data-ttu-id="d7ed1-148">Aplicaciones distribuidas en las que es necesario realizar la validación de las solicitudes de forma independiente con respecto a las tareas principales o centralizar esta validación para simplificar la administración y el mantenimiento.</span><span class="sxs-lookup"><span data-stu-id="d7ed1-148">Distributed applications where it's necessary to perform request validation separately from the main tasks, or to centralize this validation to simplify maintenance and administration.</span></span>

## <a name="example"></a><span data-ttu-id="d7ed1-149">Ejemplo</span><span class="sxs-lookup"><span data-stu-id="d7ed1-149">Example</span></span>

<span data-ttu-id="d7ed1-150">En un escenario hospedado en la nube, este patrón se puede implementar desacoplando el rol del equipo selector o la máquina virtual de los roles y servicios de confianza en una aplicación.</span><span class="sxs-lookup"><span data-stu-id="d7ed1-150">In a cloud-hosted scenario, this pattern can be implemented by decoupling the gatekeeper role or virtual machine from the trusted roles and services in an application.</span></span> <span data-ttu-id="d7ed1-151">Para ello, utilice un punto de conexión interno, una cola o un almacenamiento como mecanismo de comunicación intermedio.</span><span class="sxs-lookup"><span data-stu-id="d7ed1-151">Do this by using an internal endpoint, a queue, or storage as an intermediate communication mechanism.</span></span> <span data-ttu-id="d7ed1-152">En la ilustración se muestra cómo utilizar un punto de conexión interno.</span><span class="sxs-lookup"><span data-stu-id="d7ed1-152">The figure illustrates using an internal endpoint.</span></span>

![Un ejemplo del patrón que usan los roles web y de trabajo de Cloud Services](./_images/gatekeeper-endpoint.png)


## <a name="related-patterns"></a><span data-ttu-id="d7ed1-154">Patrones relacionados</span><span class="sxs-lookup"><span data-stu-id="d7ed1-154">Related patterns</span></span>

<span data-ttu-id="d7ed1-155">El [patrón Valet Key](valet-key.md) también puede ser apropiado al implementar el patrón Gatekeeper.</span><span class="sxs-lookup"><span data-stu-id="d7ed1-155">The [Valet Key pattern](valet-key.md) might also be relevant when implementing the Gatekeeper pattern.</span></span> <span data-ttu-id="d7ed1-156">Cuando se establece comunicación entre Gatekeeper y los roles de confianza se recomienda mejorar la seguridad mediante el uso de claves o tokens que limiten los permisos para acceder a los recursos.</span><span class="sxs-lookup"><span data-stu-id="d7ed1-156">When communicating between the Gatekeeper and trusted roles it's good practice to enhance security by using keys or tokens that limit permissions for accessing resources.</span></span> <span data-ttu-id="d7ed1-157">Describe cómo usar un token o una clave que proporcione a los clientes acceso directo restringido a un recurso o servicio específicos.</span><span class="sxs-lookup"><span data-stu-id="d7ed1-157">Describes how to use a token or key that provides clients with restricted direct access to a specific resource or service.</span></span>
